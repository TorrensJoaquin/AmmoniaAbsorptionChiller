class AqNH3Solution{
    constructor(){
        this.Temperature = 0;
        this.Pressure = 0;
        this.VaporPressure = 0;
        this.MolalConcentration = 0;
        this.WeightConcentration = 0;
        this.Enthalpy = 0;
    }
};
let AqNH3 ={
    TemperaturesDB : [0,4.4,10,15.5,21.1,26.6,32.2,37.7,43.3,48.8,54.4,60,65.5,71.1,76.6,82.2,87.7,93.3,98.8,104.4,110,115.5,121.1], //Ready
    ConcentrationsDBMolal : [0,5,10,15,20,25,30,35,40,45,50,55,60,65,70,75,80,85,90,95], //Ready
    ConcentrationsDBWeight : [0,4.74,9.50,14.29,19.10,23.94,28.81,33.71,38.64,43.59,48.57,53.58,58.62,63.69,68.79,73.91,79.07,84.26,89.47,94.72], //Ready
    WaterVaporPressureDB : [
        [0.09,0.084,0.079,0.074,0.07,0.065,0.06,0.056,0.051,0.047,0.042,0.038,0.034,0.03,0.025,0.021,0.017,0.013,0.008,0.004],
        [0.12,0.115,0.108,0.101,0.095,0.089,0.083,0.076,0.07,0.064,0.058,0.052,0.046,0.04,0.035,0.029,0.023,0.015,0.012,0.006],
        [0.18,0.17,0.16,0.15,0.14,0.13,0.12,0.11,0.1,0.094,0.085,0.076,0.068,0.059,0.051,0.042,0.034,0.025,0.017,0.008],
        [0.26,0.24,0.23,0.21,0.2,0.19,0.17,0.16,0.15,0.13,0.12,0.11,0.097,0.085,0.073,0.061,0.049,0.037,0.024,0.012],
        [0.36,0.34,0.32,0.3,0.28,0.26,0.25,0.23,0.21,0.19,0.17,0.15,0.14,0.12,0.1,0.086,0.069,0.052,0.034,0.017],
        [0.51,0.48,0.45,0.42,0.4,0.37,0.34,0.32,0.29,0.27,0.24,0.22,0.19,0.17,0.14,0.12,0.096,0.072,0.048,0.024],
        [0.7,0.66,0.63,0.58,0.55,0.51,0.47,0.44,0.4,0.37,0.33,0.3,0.26,0.23,0.2,0.16,0.13,0.1,0.066,0.033],
        [0.95,0.9,0.85,0.79,0.74,0.69,0.64,0.59,0.55,0.5,0.45,0.41,0.36,0.31,0.27,0.22,0.18,0.13,0.09,0.045],
        [1.27,1.2,1.14,1.07,1,0.93,0.86,0.8,0.73,0.67,0.6,0.54,0.48,0.42,0.36,0.3,0.24,0.18,0.12,0.061],
        [1.69,1.6,1.51,1.42,1.33,1.24,1.15,1.06,0.97,0.89,0.8,0.72,0.64,0.56,0.48,0.4,0.32,0.24,0.16,0.081],
        [2.22,2.1,1.98,1.86,1.74,1.62,1.51,1.39,1.28,1.17,1.05,0.95,0.84,0.74,0.63,0.53,0.42,0.32,0.21,0.1],
        [2.89,2.73,2.57,2.42,2.26,2.11,1.96,1.81,1.66,1.52,1.37,1.23,1.1,0.96,0.82,0.69,0.55,0.41,0.27,0.14],
        [3.72,3.51,3.31,3.11,2.91,2.72,2.52,2.33,2.14,1.95,1.76,1.59,1.41,1.24,1.06,0.88,0.71,0.53,0.35,0.18],
        [4.74,4.48,4.22,3.97,3.71,3.46,3.22,2.97,2.73,2.49,2.25,2.02,1.8,1.58,1.35,1.12,0.9,0.67,0.45,0.22],
        [5.99,5.66,5.34,5.02,4.7,4.38,4.07,3.75,3.45,3.15,2.84,2.56,2.28,1.99,1.71,1.42,1.13,1.85,0.57,0.3],
        [7.51,7.1,6.69,6.3,5.89,5.49,5.1,4.71,4.33,3.94,3.57,3.21,2.85,2.5,2.14,1.77,1.42,1.06,,],
        [9.34,8.83,8.32,7.82,7.32,6.83,6.34,5.86,5.38,4.91,4.44,3.99,3.55,3.1,2.65,,,,,],
        [11.53,10.9,10.27,9.65,9.04,8.43,7.83,7.23,6.64,6.06,5.48,4.93,4.38,3.81,,,,,,],
        [14.12,13.35,12.58,11.82,11.07,10.32,9.59,8.86,8.13,7.42,6.71,6.04,5.34,,,,,,,],
        [17.19,16.25,15.32,14.39,13.48,12.57,11.67,10.78,9.9,9.03,8.17,7.31,,,,,,,,],
        [20.78,19.64,18.51,17.4,16.29,15.19,14.11,13.03,11.97,10.91,9.87,,,,,,,,,],
        [24.97,23.6,22.25,20.91,19.58,18.26,16.95,15.66,14.38,13.12,11.86,,,,,,,,,],
        [29.83,28.2,26.58,25,23.39,21.82,20.25,18.71,17.18,15.67,,,,,,,,,,]
    ],
    AmmoniaVaporPressureDB : [
        [0,0.26,0.52,0.9,1.51,2.67,4.27,6.54,8.93,14.13,19.36,25.12,31.13,36.74,42.69,45.92,49.26,52.13,54.89,58.01],
        [0,0.33,0.66,1.14,1.92,3.16,5.13,7.98,11.98,17.14,23.33,30.15,37.15,43.69,49.56,54.4,58.31,61.62,64.77,68.31],
        [0,0.47,0.89,1.5,2.53,4.16,6.63,10.24,15.24,21.56,29.17,37.46,45.86,53.79,60.82,66.63,71.26,75.22,79.05,83.4],
        [0,0.62,1.19,2,3.21,5.36,8.48,13.06,19.15,26.92,36.14,46.12,56.22,65.81,73.99,80.9,86.44,91.04,95.67,100.65],
        [0,0.83,1.52,2.6,4.28,6.87,10.76,16.33,23.84,33.2,44.25,56.29,68.32,79.42,89.26,97.42,104.01,109.55,114.83,120.61],
        [0,1.04,1.98,3.34,5.45,8.69,13.52,20.29,29.4,40.69,53.84,67.97,82.36,95.52,107.06,116.42,124.2,130.57,136.35,143.7],
        [0,1.36,2.52,4.25,6.88,10.89,16.76,25.04,35.94,49.45,64.99,81.61,98.35,113.79,127.22,138.18,147.02,154.46,161.74,169.73],
        [0,1.72,3.2,5.34,8.6,13.53,20.68,30.57,43.57,59.49,77.85,97.27,116.81,134.7,150.23,162.94,173.22,181.97,190.13,199.17],
        [0,2.14,4,6.65,10.64,16.65,25.21,37.01,52.43,71.2,92.59,115.16,137.62,158.42,176.18,190.85,203.02,212.71,222.22,232.79],
        [0,2.67,4.95,8.21,13.09,20.3,30.54,44.56,62.62,84.44,109.4,135.48,161.44,185.14,205.81,222.28,236.05,247.14,258.24,270.02],
        [0,3.28,6.09,10.05,15.93,24.58,36.74,53.16,74.27,99.69,128.45,158.45,188.16,215.14,238.7,257.87,272.88,286.08,298.46,311.8],
        [0,3.97,7.41,12.21,19.23,29.43,43.77,62.97,87.53,116.72,149.93,184.17,218.18,248.7,275.33,297.12,314.45,328.99,342.93,358.46],
        [0,4.78,8.92,14.7,23.09,35.09,51.91,74.28,102.51,136.15,173.64,212.91,251.24,286,316.24,340.82,360.39,376.57,392.45,409.62],
        [0,5.68,10.7,17.57,27.45,41.56,61.03,86.91,119.37,157.71,200.45,244.98,288.38,327.82,361.75,389.08,411.3,429.73,447.35,466.38],
        [0,6.75,12.67,20.85,32.41,48.89,71.48,101.09,138.3,181.95,230.36,280.54,329.42,373.61,411.59,442.28,466.67,487.85,507.63,528.5],
        [0,7.9,14.96,24.56,38.13,57.19,83.07,116.97,159.37,208.66,263.43,319.89,374.25,424.1,466.26,500.63,528.08,551.24,,],
        [0,9.23,17.55,28.78,44.49,66.49,96.22,134.89,182.72,238.39,299.86,363.11,424.15,479.4,526.15,,,,,],
        [0,10.7,20.45,33.49,51.58,76.9,110.85,154.58,208.56,270.94,340.02,410.17,478.62,539.79,,,,,,],
        [0,12.26,23.68,38.76,59.65,88.48,126.83,176.24,236.97,307.08,383.99,462.36,537.56,,,,,,,],
        [0,14.02,27.15,44.61,68.43,101.24,144.74,200.46,268.3,346.07,431.43,518.19,,,,,,,,],
        [0,15.95,31.09,51.06,78.14,115.45,164.17,226.67,302.53,389.29,483.53,,,,,,,,,],
        [0,17.92,35.4,58,89.02,130.94,185.79,255.26,339.72,435.78,540.44,,,,,,,,,],
        [0,20.12,40.09,65.74,100.69,147.66,209.37,286.89,380.42,486.73,,,,,,,,,,]
    ],
    MolalPercentOfWaterDB :[
        [100,24.3,13.2,7.63,4.43,2.5,1.43,0.856,0.514,0.335,0.216,0.151,0.109,0.0816,0.0585,0.0457,0.0345,0.0249,0.0146,0.00689],
        [100,25.3,14.1,8.15,4.73,2.74,1.59,0.943,0.581,0.372,0.248,0.172,0.124,0.0914,0.0706,0.0533,0.0395,0.0243,0.0185,0.00879],
        [100,26.6,15.2,9.09,5.24,3.03,1.78,1060,0.652,0.434,0.29,0.202,0.148,0.1095,0.0838,0.063,0.0477,0.0332,0.0215,0.00959],
        [100,27.9,16.2,9.5,5.69,3.42,1.97,1210,0.777,0.481,0.331,0.238,0.172,0.129,0.0986,0.0754,0.0566,0.0406,0.0251,0.01125],
        [100,29.1,17.4,10.3,6.14,3.65,2.27,1390,0.873,0.569,0.383,0.266,0.205,0.151,0.112,0.0882,0.0656,0.0474,0.0296,0.0135],
        [100,31.6,18.5,11.2,6.89,4.08,2.45,1550,0.978,0.659,0.444,0.323,0.23,0.175,0.13,0.103,0.0772,0.0528,0.0351,0.0167],
        [100,32.7,20,12,7.4,4.47,2.73,1730,1100,0.742,0.505,0.366,0.267,0.202,0.157,0.115,0.0884,0.0647,0.0408,0.0194],
        [100,34.4,21,12.9,7.92,4.85,3,1890,1250,0.834,0.574,0.42,0.307,0.229,0.179,0.135,0.104,0.0714,0.0473,0.0226],
        [100,35.9,22.2,13.8,8.59,5.29,3.3,2110,1370,0.932,0.644,0.466,0.347,0.264,0.208,0.157,0.118,0.0846,0.054,0.0262],
        [100,37.5,23.4,14.7,9.22,5.75,3.63,2320,1520,1044,0.714,0.529,0.395,0.302,0.233,0.18,0.135,0.097,0.0619,0.03],
        [100,39,24.5,15.6,9.85,6.18,3.95,2550,1690,1160,0.811,0.596,0.444,0.343,0.263,0.205,0.154,0.1117,0.0703,0.0339],
        [100,40.7,25.8,16.5,10.5,6.69,4.28,2790,1860,1286,0.906,0.663,0.501,0.384,0.297,0.232,0.175,0.124,0.0786,0.0385],
        [100,42.3,27.1,17.5,11.2,7.19,4.63,3080,2040,1410,1004,0.741,0.558,0.432,0.334,0.257,0.197,0.14,0.0892,0.0439],
        [100,44.1,28.3,18.4,11.9,7.69,5.01,3300,2230,1550,1110,0.818,0.617,0.48,0.372,0.287,0.218,0.154,0.1005,0.0499],
        [100,45.6,29.6,19.4,12.7,8.22,5.38,3580,2430,1700,1220,0.904,0.689,0.53,0.414,0.32,0.242,0.174,0.112,0.0567],
        [100,47.3,30.9,20.4,13.4,8.76,5.78,3.87,2.64,1.85,1.34,0.994,0.756,0.586,0.456,0.352,0.268,0.192,,],
        [100,48.7,32.2,21.4,14.1,9.31,6.18,4.16,2.86,2.02,1.46,1.087,0.83,0.642,0.501,,,,,],
        [100,50.4,33.4,22.3,14.9,9.88,6.59,4.47,3.08,2.19,1.58,1.187,0.907,0.701,,,,,,],
        [100,52.1,34.7,23.4,15.7,10.45,7.03,4.78,3.31,2.36,1.72,1.272,0.983,,,,,,,],
        [100,53.7,36.1,24.4,16.4,11.05,7.48,5.1,3.56,2.54,1.86,1.39,,,,,,,,],
        [100,55.2,37.3,25.4,17.3,11.63,7.91,5.44,3.81,2.73,2,,,,,,,,,],
        [100,56.8,38.6,26.5,18,12.24,8.36,5.78,4.06,2.92,2.15,,,,,,,,,],
        [100,58.4,39.8,27.5,18.8,12.88,8.82,6.12,4.34,3.12,,,,,,,,,,]
    ],
    TotalVaporPressureDB : [
        [0.09,0.34,0.6,0.97,1.58,2.6,4.2,6.54,9.93,14.18,19.4,25.16,31.16,36.77,42.72,45.94,49.28,52.14,54.9,58.01],
        [0.12,0.45,0.77,1.24,2.01,3.25,5.21,8.06,12.05,17.2,23.39,30.2,37.2,43.73,49.6,54.43,58.33,61.64,64.78,68.32],
        [0.18,0.64,1.05,1.65,2.67,4.29,6.75,10.35,15.34,21.65,29.26,37.54,45.93,53.85,60.87,66.67,71.29,75.25,79.07,83.41],
        [0.26,0.86,1.42,2.21,3.51,5.55,8.65,13.22,19.3,27.05,36.26,46.23,56.32,65.9,74.06,80.96,86.49,91.08,95.69,100.66],
        [0.36,1.17,1.84,2.9,4.56,7.13,11.01,16.56,24.05,33.39,44.42,56.44,68.46,79.54,89.36,97.51,104.08,109.6,114.86,120.63],
        [0.51,1.52,2.43,3.76,5.85,9.06,13.86,20.61,29.69,40.96,54.08,68.19,82.55,95.69,107.2,116.54,124.3,130.64,136.4,143.72],
        [0.7,2.02,3.15,4.83,7.43,11.4,17.23,25.48,36.34,49.82,65.32,81.91,98.61,114.02,127.42,138.34,147.15,154.56,161.81,169.76],
        [0.95,2.62,4.05,6.13,9.34,14.22,21.32,31.16,44.12,59.99,78.3,97.68,117.17,135.01,150.5,163.16,173.4,182.1,190.22,199.22],
        [1.27,3.34,5.14,7.72,11.64,17.58,26.07,37.81,53.16,71.87,93.19,115.7,138.1,158.84,176.54,191.15,203.26,212.89,222.34,232.85],
        [1.69,4.27,6.46,9.63,14.42,21.54,31.69,45.62,63.59,85.33,110.2,136.2,162.08,185.7,206.29,222.68,236.37,247.38,258.4,270.1],
        [2.22,5.38,8.07,11.91,17.67,26.2,38.25,54.55,75.55,100.86,129.5,159,189,215.88,239.33,258.4,273.3,286.4,298.67,311.9],
        [2.89,6.7,9.98,14.63,21.49,31.54,45.73,64.78,89.19,118.24,151.3,185.4,219.28,249.66,276.15,297.81,315,329.4,343.2,358.6],
        [3.72,8.29,12.23,17.81,26,37.81,54.43,76.61,104.65,138.1,175.4,214.5,252.65,287.24,317.3,341.7,361.1,377.1,392.8,409.8],
        [4.74,10.16,14.92,21.54,31.16,45.02,64.25,89.88,122.1,160.2,202.7,247,290.18,329.4,363.1,390.2,412.2,430.4,447.8,466.6],
        [5.99,12.41,18.01,25.87,37.11,53.27,75.55,104.84,141.75,185.1,233.2,283.1,331.7,375.6,413.3,443.7,467.8,488.7,508.2,528.8],
        [7.51,15,21.65,30.86,44.02,62.68,88.17,121.68,163.7,212.6,267,323.1,377.1,426.6,468.4,502.4,529.5,552.3,,],
        [9.34,18.06,25.87,36.6,51.81,73.32,102.56,140.75,188.1,243.3,304.3,367.1,427.7,482.5,528.8,,,,,],
        [11.53,21.6,30.72,43.14,60.62,85.33,118.68,161.81,215.2,277,345.5,415.1,483,543.6,,,,,,],
        [14.12,25.61,36.26,50.58,70.72,98.8,136.42,185.1,245.1,314.5,390.7,468.4,542.9,,,,,,,],
        [17.19,30.27,42.47,59,81.91,113.81,156.41,211.24,278.2,355.1,439.6,525.5,,,,,,,,],
        [20.78,35.59,49.6,68.46,94.43,130.64,178.28,239.7,314.5,400.2,493.4,,,,,,,,,],
        [24.97,41.52,57.65,78.91,108.6,149.2,202.74,270.92,354.1,448.9,552.3,,,,,,,,,],
        [29.83,48.32,66.67,90.74,124.08,169.48,229.62,305.6,397.6,502.4,552.3,,,,,,,,,]        
    ],
    WaterVaporPressure:function(Temperature, MolalConcentration){
        let PositionsX = FindClosestPositions(Temperature, this.TemperaturesDB);
        let PositionsY = [];
        PositionsY[0] = RegretionByPoints( MolalConcentration, this.ConcentrationsDBMolal, this.WaterVaporPressureDB[PositionsX[0]]);
        PositionsY[1] = RegretionByPoints( MolalConcentration, this.ConcentrationsDBMolal, this.WaterVaporPressureDB[PositionsX[1]]);
        let dy = PositionsY[1] - PositionsY[0];
        let dx = this.ConcentrationsDBMolal[PositionsX[1]] - this.ConcentrationsDBMolal[PositionsX[0]];
        let DeltaX = Temperature - this.ConcentrationsDBMolal[PositionsX[0]];
        // y0 + dy/dx * DeltaX
        let result;
        if (dy != 0){
            result = PositionsY[0] - dy/dx*DeltaX;
        }else{
            result = PositionsY[0];
        }
        return result;
    },
    AmmoniaVaporPressure:function(Temperature, MolalConcentration){
        let PositionsX = FindClosestPositions(Temperature, this.TemperaturesDB);
        let PositionsY = [];
        PositionsY[0] = RegretionByPoints( MolalConcentration, this.ConcentrationsDBMolal, this.AmmoniaVaporPressureDB[PositionsX[0]]);
        PositionsY[1] = RegretionByPoints( MolalConcentration, this.ConcentrationsDBMolal, this.AmmoniaVaporPressureDB[PositionsX[1]]);
        let dy = PositionsY[1] - PositionsY[0];
        let dx = this.ConcentrationsDBMolal[PositionsX[1]] - this.ConcentrationsDBMolal[PositionsX[0]];
        let DeltaX = Temperature - this.ConcentrationsDBMolal[PositionsX[0]];
        // y0 + dy/dx * DeltaX
        let result;
        if (dy != 0){
            result = PositionsY[0] - dy/dx*DeltaX;
        }else{
            result = PositionsY[0];
        }
        return result;
    },
    VaporPressure:function(Temperature, MolalConcentration){
        let PositionsX = FindClosestPositions(Temperature, this.TemperaturesDB);
        let PositionsY = [];
        PositionsY[0] = RegretionByPoints( MolalConcentration, this.ConcentrationsDBMolal, this.TotalVaporPressureDB[PositionsX[0]]);
        PositionsY[1] = RegretionByPoints( MolalConcentration, this.ConcentrationsDBMolal, this.TotalVaporPressureDB[PositionsX[1]]);
        let dy = PositionsY[1] - PositionsY[0];
        let dx = this.ConcentrationsDBMolal[PositionsX[1]] - this.ConcentrationsDBMolal[PositionsX[0]];
        let DeltaX = Temperature - this.ConcentrationsDBMolal[PositionsX[0]];
        // y0 + dy/dx * DeltaX
        let result;
        if (dy != 0){
            result = PositionsY[0] - dy/dx*DeltaX;
        }else{
            result = PositionsY[0];
        }
        return result;
    },
    GasComposition:function(Temperature, MolalConcentration){
        let PdVWater = this.WaterVaporPressure(Temperature, MolalConcentration);
        let PdVTotal = this.VaporPressure(Temperature, MolalConcentration);
        let YWater = PdVWater/(PdVTotal + 0.0001);
        return [1 - YWater,YWater];
    },
    WaterVaporTemperature:function(Pressure, MolalConcentration){
        let LowerTemperature = 0;
        let HigherTemperature = 121.1;
        let MiddleTemperature = (HigherTemperature + LowerTemperature) * 0.5;
        for(let i = 0; i < 40; i++){
            VaporPressure = this.WaterVaporPressure(MiddleTemperature, MolalConcentration);
            if (VaporPressure > Pressure){
                HigherTemperature = MiddleTemperature;
                MiddleTemperature = (HigherTemperature + LowerTemperature) * 0.5;
            }else{
                LowerTemperature = MiddleTemperature;
                MiddleTemperature = (HigherTemperature + LowerTemperature) * 0.5;
            }
        }
        return MiddleTemperature;
    },
    AmmoniaVaporTemperature:function(Pressure, MolalConcentration){
        let LowerTemperature = 0;
        let HigherTemperature = 121.1;
        let MiddleTemperature = (HigherTemperature + LowerTemperature) * 0.5;
        for(let i = 0; i < 40; i++){
            VaporPressure = this.AmmoniaVaporPressure(MiddleTemperature, MolalConcentration);
            if (VaporPressure > Pressure){
                HigherTemperature = MiddleTemperature;
                MiddleTemperature = (HigherTemperature + LowerTemperature) * 0.5;
            }else{
                LowerTemperature = MiddleTemperature;
                MiddleTemperature = (HigherTemperature + LowerTemperature) * 0.5;
            }
        }
        return MiddleTemperature;
    },
    VaporTemperature:function(Pressure, MolalConcentration){
        let LowerTemperature = 0;
        let HigherTemperature = 121.1;
        let MiddleTemperature = (HigherTemperature + LowerTemperature) * 0.5;
        for(let i = 0; i < 40; i++){
            VaporPressure = this.VaporPressure(MiddleTemperature, MolalConcentration);
            if (VaporPressure > Pressure){
                HigherTemperature = MiddleTemperature;
                MiddleTemperature = (HigherTemperature + LowerTemperature) * 0.5;
            }else{
                LowerTemperature = MiddleTemperature;
                MiddleTemperature = (HigherTemperature + LowerTemperature) * 0.5;
            }
        }
        return MiddleTemperature;
    },
    Enthalpy:function(Temperature, MolalConcentration){
    },
}